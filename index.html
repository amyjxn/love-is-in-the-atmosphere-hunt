<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Love is in the Atmosphere ‚Äì Chicago Clue Hunt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 1.5rem;
      background: #b0cfe8;
      color: #000;
    }

    .page {
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      font-size: 1.8rem;
      text-align: center;
      margin-bottom: 0.25rem;
      color: #000;
    }

    h2 {
      font-size: 1.2rem;
      margin: 0 0 0.25rem 0;
      color: #000;
    }

    .subtitle {
      text-align: center;
      font-size: 0.95rem;
      color: #000;
      margin-bottom: 1.5rem;
    }

    .info {
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
      color: #000;
    }

    .info ul {
      padding-left: 1.2rem;
      margin: 0.25rem 0 0;
    }

    .clue {
      background: rgba(0, 0, 0, 0.04);
      border-radius: 0.9rem;
      padding: 1rem;
      margin-bottom: 1rem;
      border: 1px solid rgba(0, 0, 0, 0.15);
      color: #000;
    }

    .location-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #000;
      margin-bottom: 0.2rem;
      font-weight: bold;
    }

    .clue p {
      margin: 0.25rem 0 0.75rem 0;
      font-size: 0.9rem;
      color: #000;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      cursor: pointer;
      background: #ff9a62;
      color: #000;
      font-weight: 600;
    }

    button:active {
      transform: scale(0.97);
    }

    .clue-content {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px dashed rgba(0, 0, 0, 0.2);
      display: none;
      font-size: 0.9rem;
      color: #000;
    }

    .clue.unlocked {
      border-color: #4ade80;
      box-shadow: 0 0 0 1px rgba(74, 222, 128, 0.3);
    }

    .status {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: #444;
    }

    .footer {
      margin-top: 2rem;
      font-size: 0.8rem;
      text-align: center;
      color: #444;
    }

    .code-banner {
      display: none;
      margin: 1.5rem 0;
      padding: 1rem;
      border-radius: 0.9rem;
      background: rgba(74, 222, 128, 0.15);
      border: 1px solid rgba(74, 222, 128, 0.6);
      font-size: 0.95rem;
      text-align: center;
      color: #000;
    }

    .code-banner strong {
      font-size: 1.05rem;
    }
  </style>
</head>
<body>
  <div class="page">
    <h1>Love is in the Atmosphere</h1>
    <div class="subtitle">Chicago IRL Clue Hunt</div>

    <div class="info">
      <p><strong>How it works:</strong></p>
      <ul>
        <li>Go to any one of the locations listed below.</li>
        <li>When you‚Äôre nearby, tap ‚ÄúCheck My Location‚Äù.</li>
        <li>If you‚Äôre close enough, the clue will unlock and reveal your code. The first ten people to use it will receive a free ticket!</li>
      </ul>
    </div>

    <!-- GLOBAL CODE BANNER -->
    <div class="code-banner" id="code-banner">
      üéâ You've received a coupon!<br />
      If you're one of the first 10 winners, you'll receive a free ticket.<br /><br />
      Your code is:<br />
      <strong>TJRSUPERFAN</strong>
    </div>

    <!-- TEST CLUE -->
    <section class="clue" id="auroraTest">
      <div class="location-label">Test Clue</div>
      <p>
        Stand near <strong>251 W Downer Place, Aurora, IL 60506</strong> and tap the button below to test geolocation.
      </p>
      <button data-key="auroraTest">Check My Location</button>
      <div class="status" id="auroraTest-status"></div>
      <div class="clue-content" id="auroraTest-content">
        <strong>Unlocked test clue:</strong><br />
        The geolocation system is working! Your code has been revealed above.
      </div>
    </section>

    <!-- CLUE 1 -->
    <section class="clue" id="navyPier">
      <div class="location-label">Clue #1</div>
      <button data-key="navyPier">Check My Location</button>
      <div class="status" id="navyPier-status"></div>
      <div class="clue-content" id="navyPier-content">
        Look for the wheel that touches the sky‚Äîthe one you can see from half the city. Your clue is nearby, if you give the area a quick spin...
      </div>
    </section>

    <!-- CLUE 2 -->
    <section class="clue" id="lincolnParkZoo">
      <div class="location-label">Clue #2</div>
      <button data-key="lincolnParkZoo">Check My Location</button>
      <div class="status" id="lincolnParkZoo-status"></div>
      <div class="clue-content" id="lincolnParkZoo-content">
        Growl, roar, chirp, hiss, croak! Stand outside the entrance that shares a name with our governor. Your free ticket is almost in your paws!
      </div>
    </section>

    <!-- CLUE 3 -->
    <section class="clue" id="cloudGate">
      <div class="location-label">Clue #3</div>
      <button data-key="cloudGate">Check My Location</button>
      <div class="status" id="cloudGate-status"></div>
      <div class="clue-content" id="cloudGate-content">
        There's never BEAN a more iconic piece of art! When you spot your reflection, you're in the right place.
      </div>
    </section>

    <!-- CLUE 4 -->
    <section class="clue" id="chicagoTheatre">
      <div class="location-label">Clue #4</div>
      <button data-key="chicagoTheatre">Check My Location</button>
      <div class="status" id="chicagoTheatre-status"></div>
      <div class="clue-content" id="chicagoTheatre-content">
        All the world's a stage! Find the marquee that lights up State Street. When you see the city's name in bright lights, your clue is steps away.
      </div>
    </section>

    <!-- CLUE 5 -->
    <section class="clue" id="buckingham">
      <div class="location-label">Clue #5</div>
      <button data-key="buckingham">Check My Location</button>
      <div class="status" id="buckingham-status"></div>
      <div class="clue-content" id="buckingham-content">
        Is that a whale? No, but it spouts like one! Near this monument in Grant Park, your search comes full circle.
      </div>
    </section>

    <div class="footer">
      Make sure location services are enabled and try moving closer to each landmark.
    </div>
  </div>

  <script>
    // Approximate coordinates for each location (latitude, longitude, radius in meters)
    const locations = {
      auroraTest: {
        lat: 41.759,
        lon: -88.32,
        radiusMeters: 500 // keep generous for your personal testing
      },
      navyPier: {
        lat: 41.8917,
        lon: -87.6079,
        radiusMeters: 110
      },
      lincolnParkZoo: {
        lat: 41.9209,
        lon: -87.6323,
        radiusMeters: 110
      },
      cloudGate: {
        lat: 41.8826,
        lon: -87.6233,
        radiusMeters: 110
      },
      chicagoTheatre: {
        lat: 41.8854,
        lon: -87.6278,
        radiusMeters: 110
      },
      buckingham: {
        lat: 41.8758,
        lon: -87.6189,
        radiusMeters: 110
      }
    };

    function getDistanceMeters(lat1, lon1, lat2, lon2) {
      const R = 6371e3;
      const toRad = deg => deg * Math.PI / 180;
      const œÜ1 = toRad(lat1), œÜ2 = toRad(lat2);
      const ŒîœÜ = toRad(lat2 - lat1), ŒîŒª = toRad(lon2 - lon1);
      const a =
        Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +
        Math.cos(œÜ1) * Math.cos(œÜ2) *
        Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);
      return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    }

    function updateStatus(key, msg) {
      const el = document.getElementById(key + "-status");
      if (el) el.textContent = msg;
    }

    function showCodeBanner() {
      const banner = document.getElementById("code-banner");
      if (banner) banner.style.display = "block";
    }

    function unlockClue(key) {
      const clueEl = document.getElementById(key + "-content");
      const sectionEl = document.getElementById(key);
      if (clueEl) clueEl.style.display = "block";
      if (sectionEl) sectionEl.classList.add("unlocked");
      showCodeBanner();
    }

    function checkLocation(key) {
      const loc = locations[key];
      if (!loc) return;

      if (!navigator.geolocation) {
        alert("Location support is not available in this browser. Please enable location services.");
        return;
      }

      updateStatus(key, "Checking your location‚Ä¶");

      navigator.geolocation.getCurrentPosition(
        pos => {
          const userLat = pos.coords.latitude;
          const userLon = pos.coords.longitude;
          const d = getDistanceMeters(userLat, userLon, loc.lat, loc.lon);

          if (d <= loc.radiusMeters) {
            unlockClue(key);
            updateStatus(key, "You‚Äôre close enough! Clue unlocked.");
          } else {
            updateStatus(key, "You‚Äôre about " + Math.round(d) +
              " meters away. Move closer and try again.");
          }
        },
        err => {
          console.error(err);
          updateStatus(key, "Unable to get your location. Please allow access and try again.");
          alert("Could not get your location. Please allow location access in your browser settings.");
        }
      );
    }

    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll("button[data-key]").forEach(btn => {
        btn.addEventListener("click", () => checkLocation(btn.dataset.key));
      });
    });
  </script>
</body>
</html>
